CREATE OR REPLACE FUNCTION delete_rejected_match()
RETURNS TRIGGER AS $$
BEGIN
    IF NEW.accepted = FALSE THEN
        DELETE FROM matches WHERE match_id = NEW.match_id;
        RETURN NULL;
    END IF;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trg_delete_rejected_match
BEFORE INSERT OR UPDATE ON matches
FOR EACH ROW
EXECUTE FUNCTION delete_rejected_match();
